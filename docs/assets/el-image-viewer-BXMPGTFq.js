import{j as D,b as Te,n as ye,h as K,a8 as _e,o as fe,ab as Ne,ac as Oe,H as ke,p as Ee,v as xe,F as B,D as Ae,ad as $e,ae as Re,af as Be,ag as He,ah as Ve,ai as Me,_ as Ie,E as M,a6 as F,w as Se,r as De,aj as Fe}from"./base-DWc1T_OZ.js";import{d as re,a3 as ve,r as C,ae as Ye,s as Pe,c as I,w as me,A as oe,o as Le,h as S,v as pe,t as b,x,M as E,n as h,u as a,k as ge,Q as Xe,z as $,j as A,F as le,a1 as je,_ as Ke,l as We,G as Ue,e as se,H as Ge,I as Ze,ad as qe,L as Qe,y as Je,B as et,i as tt}from"./index-D5iT9OGn.js";import{k as nt}from"./el-message-nU1Hnnk2.js";import{a as at,f as st,g as Ce,t as ot}from"./el-scrollbar-Bx6k3odp.js";const lt=(e,o)=>{if(!D||!e||!o)return!1;const t=e.getBoundingClientRect();let l;return o instanceof Element?l=o.getBoundingClientRect():l={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<l.bottom&&t.bottom>l.top&&t.right>l.left&&t.left<l.right},we=e=>{let o=0,t=e;for(;t;)o+=t.offsetTop,t=t.offsetParent;return o},rt=(e,o)=>Math.abs(we(e)-we(o));var it="Expected a function";function W(e,o,t){var l=!0,r=!0;if(typeof e!="function")throw new TypeError(it);return Te(t)&&(l="leading"in t?!!t.leading:l,r="trailing"in t?!!t.trailing:r),at(e,o,{leading:l,maxWait:o,trailing:r})}const ct=ye({urlList:{type:K(Array),default:()=>_e([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:K(String)}}),ut={close:()=>!0,switch:e=>fe(e),rotate:e=>fe(e)},dt=["src","crossorigin"],ft=re({name:"ElImageViewer"}),vt=re({...ft,props:ct,emits:ut,setup(e,{expose:o,emit:t}){var l;const r=e,f={CONTAIN:{name:"contain",icon:ve(Ne)},ORIGINAL:{name:"original",icon:ve(Oe)}},{t:w}=ke(),c=Ee("image-viewer"),{nextZIndex:y}=xe(),p=C(),m=C([]),z=Ye(),k=C(!0),d=C(r.initialIndex),R=Pe(f.CONTAIN),u=C({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),H=C((l=r.zIndex)!=null?l:y()),ie=I(()=>{const{urlList:s}=r;return s.length<=1}),U=I(()=>d.value===0),G=I(()=>d.value===r.urlList.length-1),Y=I(()=>r.urlList[d.value]),ce=I(()=>[c.e("btn"),c.e("prev"),c.is("disabled",!r.infinite&&U.value)]),Z=I(()=>[c.e("btn"),c.e("next"),c.is("disabled",!r.infinite&&G.value)]),P=I(()=>{const{scale:s,deg:i,offsetX:v,offsetY:T,enableTransition:O}=u.value;let _=v/s,N=T/s;switch(i%360){case 90:case-270:[_,N]=[N,-_];break;case 180:case-180:[_,N]=[-_,-N];break;case 270:case-90:[_,N]=[-N,_];break}const V={transform:`scale(${s}) rotate(${i}deg) translate(${_}px, ${N}px)`,transition:O?"transform .3s":""};return R.value.name===f.CONTAIN.name&&(V.maxWidth=V.maxHeight="100%"),V});function X(){q(),t("close")}function ue(){const s=W(v=>{switch(v.code){case M.esc:r.closeOnPressEscape&&X();break;case M.space:ne();break;case M.left:ae();break;case M.up:g("zoomIn");break;case M.right:n();break;case M.down:g("zoomOut");break}}),i=W(v=>{const T=v.deltaY||v.deltaX;g(T<0?"zoomIn":"zoomOut",{zoomRate:r.zoomRate,enableTransition:!1})});z.run(()=>{F(document,"keydown",s),F(document,"wheel",i)})}function q(){z.stop()}function Q(){k.value=!1}function J(s){k.value=!1,s.target.alt=w("el.image.error")}function ee(s){if(k.value||s.button!==0||!p.value)return;u.value.enableTransition=!1;const{offsetX:i,offsetY:v}=u.value,T=s.pageX,O=s.pageY,_=W(V=>{u.value={...u.value,offsetX:i+V.pageX-T,offsetY:v+V.pageY-O}}),N=F(document,"mousemove",_);F(document,"mouseup",()=>{N()}),s.preventDefault()}function te(){u.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ne(){if(k.value)return;const s=nt(f),i=Object.values(f),v=R.value.name,O=(i.findIndex(_=>_.name===v)+1)%s.length;R.value=f[s[O]],te()}function j(s){const i=r.urlList.length;d.value=(s+i)%i}function ae(){U.value&&!r.infinite||j(d.value-1)}function n(){G.value&&!r.infinite||j(d.value+1)}function g(s,i={}){if(k.value)return;const{minScale:v,maxScale:T}=r,{zoomRate:O,rotateDeg:_,enableTransition:N}={zoomRate:r.zoomRate,rotateDeg:90,enableTransition:!0,...i};switch(s){case"zoomOut":u.value.scale>v&&(u.value.scale=Number.parseFloat((u.value.scale/O).toFixed(3)));break;case"zoomIn":u.value.scale<T&&(u.value.scale=Number.parseFloat((u.value.scale*O).toFixed(3)));break;case"clockwise":u.value.deg+=_,t("rotate",u.value.deg);break;case"anticlockwise":u.value.deg-=_,t("rotate",u.value.deg);break}u.value.enableTransition=N}return me(Y,()=>{oe(()=>{const s=m.value[0];s!=null&&s.complete||(k.value=!0)})}),me(d,s=>{te(),t("switch",s)}),Le(()=>{var s,i;ue(),(i=(s=p.value)==null?void 0:s.focus)==null||i.call(s)}),o({setActiveItem:j}),(s,i)=>(S(),pe(Ze,{to:"body",disabled:!s.teleported},[b(Ge,{name:"viewer-fade",appear:""},{default:x(()=>[E("div",{ref_key:"wrapper",ref:p,tabindex:-1,class:h(a(c).e("wrapper")),style:ge({zIndex:H.value})},[E("div",{class:h(a(c).e("mask")),onClick:i[0]||(i[0]=Xe(v=>s.hideOnClickModal&&X(),["self"]))},null,2),$(" CLOSE "),E("span",{class:h([a(c).e("btn"),a(c).e("close")]),onClick:X},[b(a(B),null,{default:x(()=>[b(a(Ae))]),_:1})],2),$(" ARROW "),a(ie)?$("v-if",!0):(S(),A(le,{key:0},[E("span",{class:h(a(ce)),onClick:ae},[b(a(B),null,{default:x(()=>[b(a($e))]),_:1})],2),E("span",{class:h(a(Z)),onClick:n},[b(a(B),null,{default:x(()=>[b(a(Re))]),_:1})],2)],64)),$(" ACTIONS "),E("div",{class:h([a(c).e("btn"),a(c).e("actions")])},[E("div",{class:h(a(c).e("actions__inner"))},[b(a(B),{onClick:i[1]||(i[1]=v=>g("zoomOut"))},{default:x(()=>[b(a(Be))]),_:1}),b(a(B),{onClick:i[2]||(i[2]=v=>g("zoomIn"))},{default:x(()=>[b(a(He))]),_:1}),E("i",{class:h(a(c).e("actions__divider"))},null,2),b(a(B),{onClick:ne},{default:x(()=>[(S(),pe(je(a(R).icon)))]),_:1}),E("i",{class:h(a(c).e("actions__divider"))},null,2),b(a(B),{onClick:i[3]||(i[3]=v=>g("anticlockwise"))},{default:x(()=>[b(a(Ve))]),_:1}),b(a(B),{onClick:i[4]||(i[4]=v=>g("clockwise"))},{default:x(()=>[b(a(Me))]),_:1})],2)],2),$(" CANVAS "),E("div",{class:h(a(c).e("canvas"))},[(S(!0),A(le,null,Ke(s.urlList,(v,T)=>We((S(),A("img",{ref_for:!0,ref:O=>m.value[T]=O,key:v,src:v,style:ge(a(P)),class:h(a(c).e("img")),crossorigin:s.crossorigin,onLoad:Q,onError:J,onMousedown:ee},null,46,dt)),[[Ue,T===d.value]])),128))],2),se(s.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var mt=Ie(vt,[["__file","image-viewer.vue"]]);const pt=Se(mt),gt=ye({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:K([String,Object])},previewSrcList:{type:K(Array),default:()=>_e([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:K(String)}}),bt={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>fe(e),close:()=>!0,show:()=>!0},ht=["src","loading","crossorigin"],wt={key:0},yt=re({name:"ElImage",inheritAttrs:!1}),_t=re({...yt,props:gt,emits:bt,setup(e,{emit:o}){const t=e;let l="";const{t:r}=ke(),f=Ee("image"),w=qe(),c=st(),y=C(),p=C(!1),m=C(!0),z=C(!1),k=C(),d=C(),R=D&&"loading"in HTMLImageElement.prototype;let u,H;const ie=I(()=>[f.e("inner"),Y.value&&f.e("preview"),m.value&&f.is("loading")]),U=I(()=>w.style),G=I(()=>{const{fit:n}=t;return D&&n?{objectFit:n}:{}}),Y=I(()=>{const{previewSrcList:n}=t;return Array.isArray(n)&&n.length>0}),ce=I(()=>{const{previewSrcList:n,initialIndex:g}=t;let s=g;return g>n.length-1&&(s=0),s}),Z=I(()=>t.loading==="eager"?!1:!R&&t.loading==="lazy"||t.lazy),P=()=>{D&&(m.value=!0,p.value=!1,y.value=t.src)};function X(n){m.value=!1,p.value=!1,o("load",n)}function ue(n){m.value=!1,p.value=!0,o("error",n)}function q(){lt(k.value,d.value)&&(P(),ee())}const Q=Fe(q,200,!0);async function J(){var n;if(!D)return;await oe();const{scrollContainer:g}=t;De(g)?d.value=g:et(g)&&g!==""?d.value=(n=document.querySelector(g))!=null?n:void 0:k.value&&(d.value=Ce(k.value)),d.value&&(u=F(d,"scroll",Q),setTimeout(()=>q(),100))}function ee(){!D||!d.value||!Q||(u==null||u(),d.value=void 0)}function te(n){if(n.ctrlKey){if(n.deltaY<0)return n.preventDefault(),!1;if(n.deltaY>0)return n.preventDefault(),!1}}function ne(){Y.value&&(H=F("wheel",te,{passive:!1}),l=document.body.style.overflow,document.body.style.overflow="hidden",z.value=!0,o("show"))}function j(){H==null||H(),document.body.style.overflow=l,z.value=!1,o("close")}function ae(n){o("switch",n)}return me(()=>t.src,()=>{Z.value?(m.value=!0,p.value=!1,ee(),J()):P()}),Le(()=>{Z.value?J():P()}),(n,g)=>(S(),A("div",{ref_key:"container",ref:k,class:h([a(f).b(),n.$attrs.class]),style:ge(a(U))},[p.value?se(n.$slots,"error",{key:0},()=>[E("div",{class:h(a(f).e("error"))},Qe(a(r)("el.image.error")),3)]):(S(),A(le,{key:1},[y.value!==void 0?(S(),A("img",Je({key:0},a(c),{src:y.value,loading:n.loading,style:a(G),class:a(ie),crossorigin:n.crossorigin,onClick:ne,onLoad:X,onError:ue}),null,16,ht)):$("v-if",!0),m.value?(S(),A("div",{key:1,class:h(a(f).e("wrapper"))},[se(n.$slots,"placeholder",{},()=>[E("div",{class:h(a(f).e("placeholder"))},null,2)])],2)):$("v-if",!0)],64)),a(Y)?(S(),A(le,{key:2},[z.value?(S(),pe(a(pt),{key:0,"z-index":n.zIndex,"initial-index":a(ce),infinite:n.infinite,"zoom-rate":n.zoomRate,"min-scale":n.minScale,"max-scale":n.maxScale,"url-list":n.previewSrcList,crossorigin:n.crossorigin,"hide-on-click-modal":n.hideOnClickModal,teleported:n.previewTeleported,"close-on-press-escape":n.closeOnPressEscape,onClose:j,onSwitch:ae},{default:x(()=>[n.$slots.viewer?(S(),A("div",wt,[se(n.$slots,"viewer")])):$("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):$("v-if",!0)],64)):$("v-if",!0)],6))}});var kt=Ie(_t,[["__file","image.vue"]]);const Ht=Se(kt),L="ElInfiniteScroll",Et=50,It=200,St=0,Lt={delay:{type:Number,default:It},distance:{type:Number,default:St},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},he=(e,o)=>Object.entries(Lt).reduce((t,[l,r])=>{var f,w;const{type:c,default:y}=r,p=e.getAttribute(`infinite-scroll-${l}`);let m=(w=(f=o[p])!=null?f:p)!=null?w:y;return m=m==="false"?!1:m,m=c(m),t[l]=Number.isNaN(m)?y:m,t},{}),ze=e=>{const{observer:o}=e[L];o&&(o.disconnect(),delete e[L].observer)},Ct=(e,o)=>{const{container:t,containerEl:l,instance:r,observer:f,lastScrollTop:w}=e[L],{disabled:c,distance:y}=he(e,r),{clientHeight:p,scrollHeight:m,scrollTop:z}=l,k=z-w;if(e[L].lastScrollTop=z,f||c||k<0)return;let d=!1;if(t===e)d=m-(p+z)<=y;else{const{clientTop:R,scrollHeight:u}=e,H=rt(e,l);d=z+p>=H+R+u-y}d&&o.call(r)};function de(e,o){const{containerEl:t,instance:l}=e[L],{disabled:r}=he(e,l);r||t.clientHeight===0||(t.scrollHeight<=t.clientHeight?o.call(l):ze(e))}const zt={async mounted(e,o){const{instance:t,value:l}=o;tt(l)||ot(L,"'v-infinite-scroll' binding value must be a function"),await oe();const{delay:r,immediate:f}=he(e,t),w=Ce(e,!0),c=w===window?document.documentElement:w,y=W(Ct.bind(null,e,l),r);if(w){if(e[L]={instance:t,container:w,containerEl:c,delay:r,cb:l,onScroll:y,lastScrollTop:c.scrollTop},f){const p=new MutationObserver(W(de.bind(null,e,l),Et));e[L].observer=p,p.observe(e,{childList:!0,subtree:!0}),de(e,l)}w.addEventListener("scroll",y)}},unmounted(e){if(!e[L])return;const{container:o,onScroll:t}=e[L];o==null||o.removeEventListener("scroll",t),ze(e)},async updated(e){if(!e[L])await oe();else{const{containerEl:o,cb:t,observer:l}=e[L];o.clientHeight&&l&&de(e,t)}}},be=zt;be.install=e=>{e.directive("InfiniteScroll",be)};const Vt=be,Tt={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Nt=E("path",{fill:"currentColor",d:"M572.235 205.282v600.365a30.118 30.118 0 1 1-60.235 0V205.282L292.382 438.633a28.913 28.913 0 0 1-42.646 0a33.43 33.43 0 0 1 0-45.236l271.058-288.045a28.913 28.913 0 0 1 42.647 0L834.5 393.397a33.43 33.43 0 0 1 0 45.176a28.913 28.913 0 0 1-42.647 0l-219.618-233.23z"},null,-1),Ot=[Nt];function xt(e,o){return S(),A("svg",Tt,[...Ot])}const Mt=ve({name:"ep-top",render:xt});export{Ht as E,Mt as _,Vt as a};
