import{aC as D,q as ze,aD as Ne,T as ye,W as j,aE as _e,aF as fe,d as re,aB as ve,aG as Oe,aH as xe,aI as ke,a1 as Ee,aJ as Ae,c as C,aK as $e,aL as Re,_ as S,a2 as me,n as oe,o as Se,l as I,aj as pe,g as b,w as x,f as E,a8 as w,u as n,al as ge,h as Be,an as $,E as B,aM as Ve,e as A,F as le,aN as He,aO as Me,aP as De,aQ as Fe,ak as Ye,aR as Pe,aS as Xe,m as We,i as je,v as Ke,a7 as se,aT as Ue,aU as qe,a9 as Ie,aV as M,aW as F,aq as Le,aX as Ze,aY as Ge,t as Je,az as Qe,aZ as et,Y as tt,a_ as Ce,a$ as at,aa as nt,ad as st}from"./index-rUpndQaj.js";import{k as ot}from"./el-message-DE1bdL3Q.js";const lt=(e,o)=>{if(!D||!e||!o)return!1;const t=e.getBoundingClientRect();let l;return o instanceof Element?l=o.getBoundingClientRect():l={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<l.bottom&&t.bottom>l.top&&t.right>l.left&&t.left<l.right},he=e=>{let o=0,t=e;for(;t;)o+=t.offsetTop,t=t.offsetParent;return o},rt=(e,o)=>Math.abs(he(e)-he(o));var it="Expected a function";function K(e,o,t){var l=!0,r=!0;if(typeof e!="function")throw new TypeError(it);return ze(t)&&(l="leading"in t?!!t.leading:l,r="trailing"in t?!!t.trailing:r),Ne(e,o,{leading:l,maxWait:o,trailing:r})}const ct=ye({urlList:{type:j(Array),default:()=>_e([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:j(String)}}),ut={close:()=>!0,switch:e=>fe(e),rotate:e=>fe(e)},dt=["src","crossorigin"],ft=re({name:"ElImageViewer"}),vt=re({...ft,props:ct,emits:ut,setup(e,{expose:o,emit:t}){var l;const r=e,f={CONTAIN:{name:"contain",icon:ve(Oe)},ORIGINAL:{name:"original",icon:ve(xe)}},{t:h}=ke(),c=Ee("image-viewer"),{nextZIndex:y}=Ae(),p=C(),m=C([]),T=$e(),k=C(!0),d=C(r.initialIndex),R=Re(f.CONTAIN),u=C({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),V=C((l=r.zIndex)!=null?l:y()),ie=S(()=>{const{urlList:s}=r;return s.length<=1}),U=S(()=>d.value===0),q=S(()=>d.value===r.urlList.length-1),Y=S(()=>r.urlList[d.value]),ce=S(()=>[c.e("btn"),c.e("prev"),c.is("disabled",!r.infinite&&U.value)]),Z=S(()=>[c.e("btn"),c.e("next"),c.is("disabled",!r.infinite&&q.value)]),P=S(()=>{const{scale:s,deg:i,offsetX:v,offsetY:z,enableTransition:O}=u.value;let _=v/s,N=z/s;switch(i%360){case 90:case-270:[_,N]=[N,-_];break;case 180:case-180:[_,N]=[-_,-N];break;case 270:case-90:[_,N]=[-N,_];break}const H={transform:`scale(${s}) rotate(${i}deg) translate(${_}px, ${N}px)`,transition:O?"transform .3s":""};return R.value.name===f.CONTAIN.name&&(H.maxWidth=H.maxHeight="100%"),H});function X(){G(),t("close")}function ue(){const s=K(v=>{switch(v.code){case M.esc:r.closeOnPressEscape&&X();break;case M.space:ae();break;case M.left:ne();break;case M.up:g("zoomIn");break;case M.right:a();break;case M.down:g("zoomOut");break}}),i=K(v=>{const z=v.deltaY||v.deltaX;g(z<0?"zoomIn":"zoomOut",{zoomRate:r.zoomRate,enableTransition:!1})});T.run(()=>{F(document,"keydown",s),F(document,"wheel",i)})}function G(){T.stop()}function J(){k.value=!1}function Q(s){k.value=!1,s.target.alt=h("el.image.error")}function ee(s){if(k.value||s.button!==0||!p.value)return;u.value.enableTransition=!1;const{offsetX:i,offsetY:v}=u.value,z=s.pageX,O=s.pageY,_=K(H=>{u.value={...u.value,offsetX:i+H.pageX-z,offsetY:v+H.pageY-O}}),N=F(document,"mousemove",_);F(document,"mouseup",()=>{N()}),s.preventDefault()}function te(){u.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ae(){if(k.value)return;const s=ot(f),i=Object.values(f),v=R.value.name,O=(i.findIndex(_=>_.name===v)+1)%s.length;R.value=f[s[O]],te()}function W(s){const i=r.urlList.length;d.value=(s+i)%i}function ne(){U.value&&!r.infinite||W(d.value-1)}function a(){q.value&&!r.infinite||W(d.value+1)}function g(s,i={}){if(k.value)return;const{minScale:v,maxScale:z}=r,{zoomRate:O,rotateDeg:_,enableTransition:N}={zoomRate:r.zoomRate,rotateDeg:90,enableTransition:!0,...i};switch(s){case"zoomOut":u.value.scale>v&&(u.value.scale=Number.parseFloat((u.value.scale/O).toFixed(3)));break;case"zoomIn":u.value.scale<z&&(u.value.scale=Number.parseFloat((u.value.scale*O).toFixed(3)));break;case"clockwise":u.value.deg+=_,t("rotate",u.value.deg);break;case"anticlockwise":u.value.deg-=_,t("rotate",u.value.deg);break}u.value.enableTransition=N}return me(Y,()=>{oe(()=>{const s=m.value[0];s!=null&&s.complete||(k.value=!0)})}),me(d,s=>{te(),t("switch",s)}),Se(()=>{var s,i;ue(),(i=(s=p.value)==null?void 0:s.focus)==null||i.call(s)}),o({setActiveItem:W}),(s,i)=>(I(),pe(qe,{to:"body",disabled:!s.teleported},[b(Ue,{name:"viewer-fade",appear:""},{default:x(()=>[E("div",{ref_key:"wrapper",ref:p,tabindex:-1,class:w(n(c).e("wrapper")),style:ge({zIndex:V.value})},[E("div",{class:w(n(c).e("mask")),onClick:i[0]||(i[0]=Be(v=>s.hideOnClickModal&&X(),["self"]))},null,2),$(" CLOSE "),E("span",{class:w([n(c).e("btn"),n(c).e("close")]),onClick:X},[b(n(B),null,{default:x(()=>[b(n(Ve))]),_:1})],2),$(" ARROW "),n(ie)?$("v-if",!0):(I(),A(le,{key:0},[E("span",{class:w(n(ce)),onClick:ne},[b(n(B),null,{default:x(()=>[b(n(He))]),_:1})],2),E("span",{class:w(n(Z)),onClick:a},[b(n(B),null,{default:x(()=>[b(n(Me))]),_:1})],2)],64)),$(" ACTIONS "),E("div",{class:w([n(c).e("btn"),n(c).e("actions")])},[E("div",{class:w(n(c).e("actions__inner"))},[b(n(B),{onClick:i[1]||(i[1]=v=>g("zoomOut"))},{default:x(()=>[b(n(De))]),_:1}),b(n(B),{onClick:i[2]||(i[2]=v=>g("zoomIn"))},{default:x(()=>[b(n(Fe))]),_:1}),E("i",{class:w(n(c).e("actions__divider"))},null,2),b(n(B),{onClick:ae},{default:x(()=>[(I(),pe(Ye(n(R).icon)))]),_:1}),E("i",{class:w(n(c).e("actions__divider"))},null,2),b(n(B),{onClick:i[3]||(i[3]=v=>g("anticlockwise"))},{default:x(()=>[b(n(Pe))]),_:1}),b(n(B),{onClick:i[4]||(i[4]=v=>g("clockwise"))},{default:x(()=>[b(n(Xe))]),_:1})],2)],2),$(" CANVAS "),E("div",{class:w(n(c).e("canvas"))},[(I(!0),A(le,null,We(s.urlList,(v,z)=>je((I(),A("img",{ref_for:!0,ref:O=>m.value[z]=O,key:v,src:v,style:ge(n(P)),class:w(n(c).e("img")),crossorigin:s.crossorigin,onLoad:J,onError:Q,onMousedown:ee},null,46,dt)),[[Ke,z===d.value]])),128))],2),se(s.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var mt=Ie(vt,[["__file","image-viewer.vue"]]);const pt=Le(mt),gt=ye({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:j([String,Object])},previewSrcList:{type:j(Array),default:()=>_e([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:j(String)}}),bt={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>fe(e),close:()=>!0,show:()=>!0},wt=["src","loading","crossorigin"],ht={key:0},yt=re({name:"ElImage",inheritAttrs:!1}),_t=re({...yt,props:gt,emits:bt,setup(e,{emit:o}){const t=e;let l="";const{t:r}=ke(),f=Ee("image"),h=Ze(),c=Ge(),y=C(),p=C(!1),m=C(!0),T=C(!1),k=C(),d=C(),R=D&&"loading"in HTMLImageElement.prototype;let u,V;const ie=S(()=>[f.e("inner"),Y.value&&f.e("preview"),m.value&&f.is("loading")]),U=S(()=>h.style),q=S(()=>{const{fit:a}=t;return D&&a?{objectFit:a}:{}}),Y=S(()=>{const{previewSrcList:a}=t;return Array.isArray(a)&&a.length>0}),ce=S(()=>{const{previewSrcList:a,initialIndex:g}=t;let s=g;return g>a.length-1&&(s=0),s}),Z=S(()=>t.loading==="eager"?!1:!R&&t.loading==="lazy"||t.lazy),P=()=>{D&&(m.value=!0,p.value=!1,y.value=t.src)};function X(a){m.value=!1,p.value=!1,o("load",a)}function ue(a){m.value=!1,p.value=!0,o("error",a)}function G(){lt(k.value,d.value)&&(P(),ee())}const J=at(G,200,!0);async function Q(){var a;if(!D)return;await oe();const{scrollContainer:g}=t;et(g)?d.value=g:tt(g)&&g!==""?d.value=(a=document.querySelector(g))!=null?a:void 0:k.value&&(d.value=Ce(k.value)),d.value&&(u=F(d,"scroll",J),setTimeout(()=>G(),100))}function ee(){!D||!d.value||!J||(u==null||u(),d.value=void 0)}function te(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function ae(){Y.value&&(V=F("wheel",te,{passive:!1}),l=document.body.style.overflow,document.body.style.overflow="hidden",T.value=!0,o("show"))}function W(){V==null||V(),document.body.style.overflow=l,T.value=!1,o("close")}function ne(a){o("switch",a)}return me(()=>t.src,()=>{Z.value?(m.value=!0,p.value=!1,ee(),Q()):P()}),Se(()=>{Z.value?Q():P()}),(a,g)=>(I(),A("div",{ref_key:"container",ref:k,class:w([n(f).b(),a.$attrs.class]),style:ge(n(U))},[p.value?se(a.$slots,"error",{key:0},()=>[E("div",{class:w(n(f).e("error"))},Je(n(r)("el.image.error")),3)]):(I(),A(le,{key:1},[y.value!==void 0?(I(),A("img",Qe({key:0},n(c),{src:y.value,loading:a.loading,style:n(q),class:n(ie),crossorigin:a.crossorigin,onClick:ae,onLoad:X,onError:ue}),null,16,wt)):$("v-if",!0),m.value?(I(),A("div",{key:1,class:w(n(f).e("wrapper"))},[se(a.$slots,"placeholder",{},()=>[E("div",{class:w(n(f).e("placeholder"))},null,2)])],2)):$("v-if",!0)],64)),n(Y)?(I(),A(le,{key:2},[T.value?(I(),pe(n(pt),{key:0,"z-index":a.zIndex,"initial-index":n(ce),infinite:a.infinite,"zoom-rate":a.zoomRate,"min-scale":a.minScale,"max-scale":a.maxScale,"url-list":a.previewSrcList,crossorigin:a.crossorigin,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:W,onSwitch:ne},{default:x(()=>[a.$slots.viewer?(I(),A("div",ht,[se(a.$slots,"viewer")])):$("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):$("v-if",!0)],64)):$("v-if",!0)],6))}});var kt=Ie(_t,[["__file","image.vue"]]);const Rt=Le(kt),L="ElInfiniteScroll",Et=50,St=200,It=0,Lt={delay:{type:Number,default:St},distance:{type:Number,default:It},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},we=(e,o)=>Object.entries(Lt).reduce((t,[l,r])=>{var f,h;const{type:c,default:y}=r,p=e.getAttribute(`infinite-scroll-${l}`);let m=(h=(f=o[p])!=null?f:p)!=null?h:y;return m=m==="false"?!1:m,m=c(m),t[l]=Number.isNaN(m)?y:m,t},{}),Te=e=>{const{observer:o}=e[L];o&&(o.disconnect(),delete e[L].observer)},Ct=(e,o)=>{const{container:t,containerEl:l,instance:r,observer:f,lastScrollTop:h}=e[L],{disabled:c,distance:y}=we(e,r),{clientHeight:p,scrollHeight:m,scrollTop:T}=l,k=T-h;if(e[L].lastScrollTop=T,f||c||k<0)return;let d=!1;if(t===e)d=m-(p+T)<=y;else{const{clientTop:R,scrollHeight:u}=e,V=rt(e,l);d=T+p>=V+R+u-y}d&&o.call(r)};function de(e,o){const{containerEl:t,instance:l}=e[L],{disabled:r}=we(e,l);r||t.clientHeight===0||(t.scrollHeight<=t.clientHeight?o.call(l):Te(e))}const Tt={async mounted(e,o){const{instance:t,value:l}=o;nt(l)||st(L,"'v-infinite-scroll' binding value must be a function"),await oe();const{delay:r,immediate:f}=we(e,t),h=Ce(e,!0),c=h===window?document.documentElement:h,y=K(Ct.bind(null,e,l),r);if(h){if(e[L]={instance:t,container:h,containerEl:c,delay:r,cb:l,onScroll:y,lastScrollTop:c.scrollTop},f){const p=new MutationObserver(K(de.bind(null,e,l),Et));e[L].observer=p,p.observe(e,{childList:!0,subtree:!0}),de(e,l)}h.addEventListener("scroll",y)}},unmounted(e){if(!e[L])return;const{container:o,onScroll:t}=e[L];o==null||o.removeEventListener("scroll",t),Te(e)},async updated(e){if(!e[L])await oe();else{const{containerEl:o,cb:t,observer:l}=e[L];o.clientHeight&&l&&de(e,t)}}},be=Tt;be.install=e=>{e.directive("InfiniteScroll",be)};const Bt=be,zt={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Nt=E("path",{fill:"currentColor",d:"M572.235 205.282v600.365a30.118 30.118 0 1 1-60.235 0V205.282L292.382 438.633a28.913 28.913 0 0 1-42.646 0a33.43 33.43 0 0 1 0-45.236l271.058-288.045a28.913 28.913 0 0 1 42.647 0L834.5 393.397a33.43 33.43 0 0 1 0 45.176a28.913 28.913 0 0 1-42.647 0l-219.618-233.23z"},null,-1),Ot=[Nt];function xt(e,o){return I(),A("svg",zt,[...Ot])}const Vt=ve({name:"ep-top",render:xt});export{Rt as E,Vt as _,Bt as a};
